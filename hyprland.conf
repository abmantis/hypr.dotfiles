$HERE=~/.config/hypr
$COMPONENTS=$HERE/components
$SCRIPTS=$HERE/scripts

################################################################################
# Commands
$wallpaper=$HERE/links/wallpaper
# Utils
$drun=wofi --normal-window # normal-window is needed for it to work on scaled displays (will be fixed in wofi)
$term=kitty
$lock=swaylock -i $wallpaper --scaling fill
$lockDaemon=$lock -f
$screenshot=$SCRIPTS/screenshot.sh

# Media
$mediaPlay=playerctl play-pause
$mediaPrev=playerctl previous
$mediaNext=playerctl next

$volRed=pulsemixer --change-volume -5
$volInc=pulsemixer --change-volume +5
$muteToggle=pulsemixer --toggle-mute 
$micMuteToggle=amixer set Capture toggle

# Brightness
$brightnessInc=brightnessctl set +5%
$brightnessRed=brightnessctl set 5%-


# Workspace names
# NOTE: the space used in workspace names is not the normal unicode space, to avoid having to use quotes.
$ws0=name:S 
$ws1=name:1 󰈹
$ws2=name:2 
$ws3=name:3 
$ws4=name:4 
$ws5=name:5 
$ws6=name:6 
$ws7=name:F1 
$ws8=name:F2 
$ws9=name:F3 
$ws10=name:F4 

# monitor=desc:California Institute of Technology 0x1603,disable
monitor=desc:California Institute of Technology 0x1603,prefered,auto,1.2
monitor=desc:Sharp Corporation 0x1453,prefered,auto,1
monitor=,preferred,auto,auto
monitor=desc:Dell Inc. DELL S3422DWG CGS4KK3,preferred,-2560x0,auto

env = XCURSOR_SIZE,24
# env = WLR_NO_HARDWARE_CURSORS,1
# env = WLR_DRM_DEVICES,/dev/dri/card1

# start with a named default workspace
exec-once = hyprctl dispatch workspace $ws1

exec-once=swaybg -i $wallpaper -m fill
exec-once=/usr/lib/x86_64-linux-gnu/libexec/polkit-kde-authentication-agent-1
exec-once=swaync -c $COMPONENTS/swaync/config.json -s $COMPONENTS/swaync/style.css
exec-once=waybar -c $COMPONENTS/waybar/config -s $COMPONENTS/waybar/style.css
exec-once=$SCRIPTS/idle_handler.sh 300 360 "$lockDaemon"

# TODO: this should start automatically
exec-once=/usr/libexec/xdg-desktop-portal-hyprland

source=$HERE/links/autostart
exec-once = sleep 5 && hyprctl keyword misc:focus_on_activate true

input {
    kb_layout = us,pt
    kb_options = compose:ralt,grp:alt_shift_toggle

    follow_mouse = 2
    touchpad {
        natural_scroll = truemovewindow
    }
}

device:at-translated-set-2-keyboard {
    kb_layout = pt
    kb_options = 
}

general {
    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg

    gaps_out = 10

    resize_on_border = true
    hover_icon_on_border = true
    cursor_inactive_timeout = 0

    layout = dwindle
}

decoration {
    rounding = 5

    blur {
        enabled = true
        size = 3
        passes = 1
        
        vibrancy = 0.1696
    }

    drop_shadow = true
    shadow_range = 4
    shadow_render_power = 3
    col.shadow = rgba(1a1a1aee)
}

animations {
    enabled = true

    bezier = myBezier, 0.05, 0.9, 0.1, 1.05

    animation = windows, 1, 7, myBezier
    animation = windowsOut, 1, 7, default, popin 80%
    animation = border, 1, 10, default
    animation = borderangle, 1, 8, default
    animation = fade, 1, 7, default
    animation = workspaces, 1, 6, default
}

dwindle {
    pseudotile = true # master switch for pseudotiling. Enabling is bound to mainMod + P in the keybinds section below
    preserve_split = true # you probably want this
}

master {
    new_is_master = true
}

gestures {
    workspace_swipe = false
}

misc {
    force_default_wallpaper = 0
    focus_on_activate = false # this is changed to true after a bit (see autostart)
}

xwayland {
    # force_zero_scaling = true
    use_nearest_neighbor = false
}

windowrulev2 = stayfocused,class:(wofi)


$mainMod = SUPER
$secMod = SUPER SHIFT

bind = $secMod, L, exit,
bind = $secMod, Q, killactive,
bind = $mainMod, F, fullscreen,
bind = $mainMod, P, pseudo, # dwindle
bind = $mainMod, S, togglesplit, # dwindle
bind = $mainMod, C, centerwindow, # floating windows
bind = $secMod, F, togglefloating,

# Move focus
bind = $secMod, left, movewindow, l
bind = $secMod, right, movewindow, r
bind = $secMod, up, movewindow, u
bind = $secMod, down, movewindow, d

# Move window
bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d

# Switch workspaces
bind = $mainMod, 1, workspace, $ws1
bind = $mainMod, 2, workspace, $ws2
bind = $mainMod, 3, workspace, $ws3
bind = $mainMod, 4, workspace, $ws4
bind = $mainMod, 5, workspace, $ws5
bind = $mainMod, 6, workspace, $ws6
bind = $mainMod, F1, workspace, $ws7
bind = $mainMod, F2, workspace, $ws8
bind = $mainMod, F3, workspace, $ws9
bind = $mainMod, F4, workspace, $ws10
bind = $mainMod, grave, workspace, $ws0

bind = $mainMod, TAB, workspace, e+1
bind = $secMod, TAB, workspace, e-1

# Move active window
bind = $secMod, 1, movetoworkspace, $ws1
bind = $secMod, 2, movetoworkspace, $ws2
bind = $secMod, 3, movetoworkspace, $ws3
bind = $secMod, 4, movetoworkspace, $ws4
bind = $secMod, 5, movetoworkspace, $ws5
bind = $secMod, 6, movetoworkspace, $ws6
bind = $secMod, F1, movetoworkspace, $ws7
bind = $secMod, F2, movetoworkspace, $ws8
bind = $secMod, F3, movetoworkspace, $ws9
bind = $secMod, F4, movetoworkspace, $ws10
bind = $secMod, grave, movetoworkspace, $ws0

# Example special workspace (scratchpad)
bind = $mainMod, minus, togglespecialworkspace, magic
bind = $secMod, minus, movetoworkspace, special:magic

# Scroll through existing workspaces with mainMod + scroll
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1

# Move/resize windows with mainMod + LMB/RMB and dragging
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow

# Audio
bindle=, xf86audiolowervolume, exec, $volRed
bindle=, xf86audioraisevolume, exec, $volInc
bindle=, xf86audiomute, exec, $muteToggle
bindle=, XF86AudioMicMute, exec, $micMuteToggle
bindle=CONTROL, F12, exec, $micMuteToggle

# Media
bindl=, XF86AudioPlay, exec, $mediaPlay
bindl=, XF86AudioPause, exec, $mediaPlay
bindl=, XF86AudioPrev, exec, $mediaPrev
bindl=, XF86AudioNext, exec, $mediaNext

# Brightness
bindle=, XF86MonBrightnessUp, exec, $brightnessInc
bindle=, XF86MonBrightnessDown, exec, $brightnessRed

# Utilities
bind = $mainMod, R, exec, $drun 
bind = $mainMod, T, exec, $term
bind = $mainMod, Escape, exec, $lock
bind = , Print, exec, $screenshot


